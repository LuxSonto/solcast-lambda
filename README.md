# SOLTRAK SSDS Developer Assessment

## Overview

This project implements a back-end service that integrates with a third-party data provider (mimicked Solcast API). It pulls in data, processes it, and stores it in a PostgreSQL database.

This assessment is designed to test skills in setting up and documenting a functional back-end module using components similar to those in our stack.

## Features

* **Data Retrieval:** Fetches data from a mock Solcast API endpoint. 
    
* **Data Processing:** Processes the retrieved data (converts pv\_power from kW to W). 
    
* **Data Storage:** Stores the processed data in a PostgreSQL database. 
    
* **Scheduled Execution:** Implemented an AWS Lambda function that pulls the data at 60-minute intervals, processes it, and stores it in the PostgreSQL database.
* **Infrastructure as Code (IaC):** Uses AWS CDK to define and deploy the infrastructure. 
    

## Deliverables

* A publicly accessible Lambda function URL.
    
* An accessible GitHub repository.
    
* Documentation on how to set up a local version and test the deployed function.
    

## Project Details

The project uses a mock Solcast API endpoint as the data source. The data returned by the API is the same as you would receive from the Solcast API, using the following queries (Radiation and Weather Data, and Rooftop PV Power Data):

* [Radiation and Weather Data](https://api.solcast.com.au//data/live/radiation_and_weather?latitude=-33.856784\&longitude=151.215297\&period=PT60M\&output_parameters=air_temp,dni,ghi,relative_humidity,surface_pressure,wind_speed_10m\&format=json\&api_key=) 
    
* [Rooftop PV Power Data](https://api.solcast.com.au/data/live/rooftop_pv_power?latitude=-33.856784\&longitude=151.215297\&period=PT60M\&output_parameters=pv_power_rooftop\&capacity=100\&format=json\&api_key=)

The data is specific to provided latitude and longitude coordinates. The example uses the Sydney Opera House (latitude: -33.856784, longitude: 151.215297). The period parameter specifies the time interval for which the data is aggregated. For example, PT60M means the data is aggregated over 60 minutes. The data pulls in the last 48 hours. 
### Data Parameters

The parameters to be returned:

* `air_temp`: Air temperature in degrees Celsius.
    
* `dni`: Direct Normal Irradiance, the amount of solar radiation received per unit area directly from the sun (W/m²).
    
* `ghi`: Global Horizontal Irradiance, the total solar radiation received per unit area on a horizontal surface (W/m²).
    
* `relative_humidity`: The amount of moisture in the air (percentage).
    
* `surface_pressure`: Atmospheric pressure at the surface (hPa). 
    
* `wind_speed_10m`: Wind speed at 10 meters above the ground (m/s).
    
* `pv_power_rooftop`: The amount of power generated by the rooftop solar system (kW).
    

The response format is a JSON object.

## Getting Started

### Prerequisites

* Node.js (version 18 or higher) and npm (version 9 or higher)
* PostgreSQL (version 14 or higher)
* AWS CLI
* AWS CDK CLI
* Typescript (version 5 or higher)

### Setup

1.  **Clone the repository:**
    
    ```bash
    git clone https://github.com/LuxSonto/solcast-lambda.git
    cd solcast-lambda
    ```
    
2.  **Install dependencies:**
    
    ```bash
    npm install
    ```
    
3.  **Set up the PostgreSQL database:**
    
    * Install PostgreSQL on your local machine.
    * Create a database named `solcast_forecasts` (or choose your own name).
    * Create a `.env` file in the project root and add your database connection details:
        
        ```
        DB_HOST=localhost
        DB_PORT=5432
        DB_NAME=solcast_forecasts
        DB_USER=your_db_user
        DB_PASSWORD=your_db_password
        ```
        
    * Run the SQL scripts located in `sql/create.sql` to create the necessary tables.
                
4.  **Build the project:**
    
    ```bash
    npm run build
    ```
    

### Running the Lambda Function Locally

You can run the Lambda function locally using the AWS Lambda Runtime Interface Emulator or a similar tool. Instructions on how to do this can be found in the AWS documentation:

* \https://qvpsvaxcjdyj5jrm7bqix2udba0kfuwm.lambda-url.eu-north-1.on.aws/

Alternatively, if you are using a framework like Serverless Framework, you can use its commands to invoke the function locally.

```bash
sls invoke local --function SolcastLambdaStack-SolcastLambda34F8AFAF-cJjpFtzeTVqe